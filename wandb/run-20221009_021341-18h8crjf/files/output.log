train epoch:1:   0%|                                                                                                                                                                  | 0/20227 [00:00<?, ?it/s]/home/yilin/anaconda3/envs/pytorch3d/lib/python3.8/site-packages/torch/nn/modules/loss.py:97: UserWarning: Using a target size (torch.Size([16, 1, 3000])) that is different to the input size (torch.Size([16, 3000])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.l1_loss(input, target, reduction=self.reduction)




train epoch:1:   0%|▏                                                                                                                                                      | 21/20227 [00:10<2:44:42,  2.04it/s]
val epoch:1:   0%|▋                                                                                                                                                            | 9/1940 [00:01<04:05,  7.86it/s]
Average loss for epoch 1: train_total_loss_cond:0.25755852460861206; train_total_loss:0.25755852460861206; train_loss_map_hand:0.12037494033575058; train_loss_map_om:0.13094830513000488; train_loss_feat:0.6235326528549194;
val epoch:1:   1%|█▋                                                                                                                                                          | 21/1940 [00:02<04:14,  7.55it/s]
train epoch:2:   0%|                                                                                                                                                                  | 0/20227 [00:00<?, ?it/s]
Average loss for epoch 1: val_total_loss_cond:0.04310563951730728; val_total_loss:0.04310563951730728; val_loss_map_hand:0.0; val_loss_map_om:0.04310563951730728; val_loss_feat:0.0;





train epoch:2:   0%|▏                                                                                                                                                      | 21/20227 [00:10<2:45:35,  2.03it/s]
Average loss for epoch 2: train_total_loss_cond:0.07059331238269806; train_total_loss:0.07059331238269806; train_loss_map_hand:0.03173231706023216; train_loss_map_om:0.03274921327829361; train_loss_feat:0.6111796498298645;
 Average metrics for epoch 2: train_metric_cond:0.031732313334941864;
val epoch:2:   1%|█▋                                                                                                                                                          | 21/1940 [00:02<03:50,  8.34it/s]
train epoch:3:   0%|                                                                                                                                                        | 2/20227 [00:00<2:41:02,  2.09it/s]
Average loss for epoch 2: val_total_loss_cond:0.017431560903787613; val_total_loss:0.017431560903787613; val_loss_map_hand:0.0; val_loss_map_om:0.017431560903787613; val_loss_feat:0.0;




train epoch:3:   0%|▏                                                                                                                                                      | 21/20227 [00:10<2:47:18,  2.01it/s]
val epoch:3:   0%|▍                                                                                                                                                            | 6/1940 [00:00<03:41,  8.71it/s]
Average loss for epoch 3: train_total_loss_cond:0.06241775304079056; train_total_loss:0.06241775304079056; train_loss_map_hand:0.028100963681936264; train_loss_map_om:0.028534438461065292; train_loss_feat:0.5782355666160583;
val epoch:3:   1%|█▋                                                                                                                                                          | 21/1940 [00:02<03:50,  8.31it/s]
train epoch:4:   0%|                                                                                                                                                                  | 0/20227 [00:00<?, ?it/s]
Average loss for epoch 3: val_total_loss_cond:0.018378805369138718; val_total_loss:0.018378805369138718; val_loss_map_hand:0.0; val_loss_map_om:0.018378805369138718; val_loss_feat:0.0;





train epoch:4:   0%|▏                                                                                                                                                      | 21/20227 [00:10<2:47:38,  2.01it/s]
val epoch:4:   1%|▊                                                                                                                                                           | 10/1940 [00:01<03:44,  8.59it/s]
Average loss for epoch 4: train_total_loss_cond:0.05537206679582596; train_total_loss:0.05537206679582596; train_loss_map_hand:0.025011032819747925; train_loss_map_om:0.024894433096051216; train_loss_feat:0.5466605424880981;
val epoch:4:   1%|█▋                                                                                                                                                          | 21/1940 [00:02<03:53,  8.20it/s]
train epoch:5:   0%|                                                                                                                                                        | 1/20227 [00:00<2:44:56,  2.04it/s]
Average loss for epoch 4: val_total_loss_cond:0.017656560987234116; val_total_loss:0.017656560987234116; val_loss_map_hand:0.0; val_loss_map_om:0.017656560987234116; val_loss_feat:0.0;




train epoch:5:   0%|▏                                                                                                                                                      | 21/20227 [00:10<2:49:39,  1.98it/s]
val epoch:5:   0%|                                                                                                                                                             | 1/1940 [00:00<03:43,  8.66it/s]
Average loss for epoch 5: train_total_loss_cond:0.05381033197045326; train_total_loss:0.05381033197045326; train_loss_map_hand:0.024364491924643517; train_loss_map_om:0.02436048723757267; train_loss_feat:0.5085363388061523;

val epoch:5:   1%|█▋                                                                                                                                                          | 21/1940 [00:02<03:53,  8.20it/s]
train epoch:6:   0%|                                                                                                                                                        | 3/20227 [00:01<2:40:55,  2.09it/s]
Average loss for epoch 5: val_total_loss_cond:0.015941761434078217; val_total_loss:0.015941761434078217; val_loss_map_hand:0.0; val_loss_map_om:0.015941761434078217; val_loss_feat:0.0;




train epoch:6:   0%|▏                                                                                                                                                      | 21/20227 [00:10<2:48:02,  2.00it/s]
val epoch:6:   0%|▍                                                                                                                                                            | 5/1940 [00:00<03:45,  8.59it/s]
Average loss for epoch 6: train_total_loss_cond:0.055165525525808334; train_total_loss:0.055165525525808334; train_loss_map_hand:0.025155171751976013; train_loss_map_om:0.025341356173157692; train_loss_feat:0.4668993651866913;
val epoch:6:   1%|█▋                                                                                                                                                          | 21/1940 [00:02<03:53,  8.21it/s]
train epoch:7:   0%|                                                                                                                                                                  | 0/20227 [00:00<?, ?it/s]
Average loss for epoch 6: val_total_loss_cond:0.018598362803459167; val_total_loss:0.018598362803459167; val_loss_map_hand:0.0; val_loss_map_om:0.018598362803459167; val_loss_feat:0.0;





train epoch:7:   0%|▏                                                                                                                                                      | 21/20227 [00:10<2:48:39,  2.00it/s]
val epoch:7:   1%|█                                                                                                                                                           | 13/1940 [00:01<03:42,  8.67it/s]
Average loss for epoch 7: train_total_loss_cond:0.05178987607359886; train_total_loss:0.05178987607359886; train_loss_map_hand:0.023793453350663185; train_loss_map_om:0.023711437359452248; train_loss_feat:0.428497314453125;
val epoch:7:   1%|█▋                                                                                                                                                          | 21/1940 [00:02<03:52,  8.27it/s]
train epoch:8:   0%|                                                                                                                                                        | 2/20227 [00:00<2:42:19,  2.08it/s]
Average loss for epoch 7: val_total_loss_cond:0.016206033527851105; val_total_loss:0.016206033527851105; val_loss_map_hand:0.0; val_loss_map_om:0.016206033527851105; val_loss_feat:0.0;




train epoch:8:   0%|▏                                                                                                                                                      | 21/20227 [00:10<2:48:27,  2.00it/s]
val epoch:8:   0%|                                                                                                                                                                     | 0/1940 [00:00<?, ?it/s]
Average loss for epoch 8: train_total_loss_cond:0.050679683685302734; train_total_loss:0.050679683685302734; train_loss_map_hand:0.02334081381559372; train_loss_map_om:0.023409252986311913; train_loss_feat:0.392962247133255;

val epoch:8:   1%|█▋                                                                                                                                                          | 21/1940 [00:02<03:52,  8.24it/s]
train epoch:9:   0%|                                                                                                                                                        | 3/20227 [00:01<2:41:45,  2.08it/s]
Average loss for epoch 8: val_total_loss_cond:0.016182148829102516; val_total_loss:0.016182148829102516; val_loss_map_hand:0.0; val_loss_map_om:0.016182148829102516; val_loss_feat:0.0;




train epoch:9:   0%|▏                                                                                                                                                      | 21/20227 [00:10<2:48:49,  1.99it/s]
val epoch:9:   0%|▋                                                                                                                                                            | 9/1940 [00:01<03:43,  8.64it/s]
Average loss for epoch 9: train_total_loss_cond:0.048981357365846634; train_total_loss:0.048981357365846634; train_loss_map_hand:0.02267381362617016; train_loss_map_om:0.022648140788078308; train_loss_feat:0.3659403324127197;
val epoch:9:   1%|█▋                                                                                                                                                          | 21/1940 [00:02<03:53,  8.21it/s]
train epoch:10:   0%|                                                                                                                                                       | 1/20227 [00:00<2:45:39,  2.03it/s]
Average loss for epoch 9: val_total_loss_cond:0.01612824574112892; val_total_loss:0.01612824574112892; val_loss_map_hand:0.0; val_loss_map_om:0.01612824574112892; val_loss_feat:0.0;





train epoch:10:   0%|▏                                                                                                                                                     | 21/20227 [00:10<2:49:43,  1.98it/s]
val epoch:10:   1%|▉                                                                                                                                                          | 12/1940 [00:01<03:42,  8.66it/s]
Average loss for epoch 10: train_total_loss_cond:0.049087923020124435; train_total_loss:0.049087923020124435; train_loss_map_hand:0.022923002019524574; train_loss_map_om:0.02282623015344143; train_loss_feat:0.3338688313961029;
val epoch:10:   1%|█▋                                                                                                                                                         | 21/1940 [00:02<03:53,  8.22it/s]
train epoch:11:   0%|                                                                                                                                                       | 1/20227 [00:00<2:47:11,  2.02it/s]
Average loss for epoch 10: val_total_loss_cond:0.01712428219616413; val_total_loss:0.01712428219616413; val_loss_map_hand:0.0; val_loss_map_om:0.01712428219616413; val_loss_feat:0.0;




train epoch:11:   0%|▏                                                                                                                                                     | 21/20227 [00:10<2:49:43,  1.98it/s]
val epoch:11:   0%|▏                                                                                                                                                           | 2/1940 [00:00<03:44,  8.63it/s]
Average loss for epoch 11: train_total_loss_cond:0.04882628843188286; train_total_loss:0.04882628843188286; train_loss_map_hand:0.02278902195394039; train_loss_map_om:0.02289017103612423; train_loss_feat:0.3147106468677521;

val epoch:11:   1%|█▋                                                                                                                                                         | 21/1940 [00:02<03:52,  8.24it/s]
train epoch:12:   0%|                                                                                                                                                       | 3/20227 [00:01<2:43:12,  2.07it/s]
Average loss for epoch 11: val_total_loss_cond:0.017078090459108353; val_total_loss:0.017078090459108353; val_loss_map_hand:0.0; val_loss_map_om:0.017078090459108353; val_loss_feat:0.0;




train epoch:12:   0%|▏                                                                                                                                                     | 21/20227 [00:10<2:49:36,  1.99it/s]
val epoch:12:   0%|▋                                                                                                                                                           | 8/1940 [00:00<03:44,  8.62it/s]
Average loss for epoch 12: train_total_loss_cond:0.04978080838918686; train_total_loss:0.04978080838918686; train_loss_map_hand:0.023404907435178757; train_loss_map_om:0.02344442531466484; train_loss_feat:0.29314661026000977;
val epoch:12:   1%|█▋                                                                                                                                                         | 21/1940 [00:02<03:52,  8.24it/s]
train epoch:13:   0%|                                                                                                                                                                 | 0/20227 [00:00<?, ?it/s]
Average loss for epoch 12: val_total_loss_cond:0.01604917086660862; val_total_loss:0.01604917086660862; val_loss_map_hand:0.0; val_loss_map_om:0.01604917086660862; val_loss_feat:0.0;





train epoch:13:   0%|▏                                                                                                                                                     | 21/20227 [00:10<2:49:41,  1.98it/s]
val epoch:13:   1%|█▎                                                                                                                                                         | 16/1940 [00:01<03:42,  8.64it/s]
Average loss for epoch 13: train_total_loss_cond:0.04809999093413353; train_total_loss:0.04809999093413353; train_loss_map_hand:0.022690143436193466; train_loss_map_om:0.02267974428832531; train_loss_feat:0.27301058173179626;
val epoch:13:   1%|█▋                                                                                                                                                         | 21/1940 [00:02<03:53,  8.23it/s]
train epoch:14:   0%|                                                                                                                                                       | 2/20227 [00:00<2:44:46,  2.05it/s]
Average loss for epoch 13: val_total_loss_cond:0.017215080559253693; val_total_loss:0.017215080559253693; val_loss_map_hand:0.0; val_loss_map_om:0.017215080559253693; val_loss_feat:0.0;




train epoch:14:   0%|▏                                                                                                                                                     | 21/20227 [00:10<2:49:50,  1.98it/s]
val epoch:14:   0%|▍                                                                                                                                                           | 5/1940 [00:00<03:43,  8.64it/s]
Average loss for epoch 14: train_total_loss_cond:0.05094856768846512; train_total_loss:0.05094856768846512; train_loss_map_hand:0.024194559082388878; train_loss_map_om:0.02419379912316799; train_loss_feat:0.25602036714553833;
val epoch:14:   1%|█▋                                                                                                                                                         | 21/1940 [00:02<03:53,  8.23it/s]

train epoch:15:   0%|                                                                                                                                                       | 4/20227 [00:01<2:42:40,  2.07it/s]
Average loss for epoch 14: val_total_loss_cond:0.017130320891737938; val_total_loss:0.017130320891737938; val_loss_map_hand:0.0; val_loss_map_om:0.017130320891737938; val_loss_feat:0.0;




train epoch:15:   0%|▏                                                                                                                                                     | 21/20227 [00:10<2:49:42,  1.98it/s]
val epoch:15:   1%|█                                                                                                                                                          | 13/1940 [00:01<03:43,  8.63it/s]
Average loss for epoch 15: train_total_loss_cond:0.04861994460225105; train_total_loss:0.04861994460225105; train_loss_map_hand:0.023130765184760094; train_loss_map_om:0.023108944296836853; train_loss_feat:0.23802292346954346;
val epoch:15:   1%|█▋                                                                                                                                                         | 21/1940 [00:02<03:53,  8.22it/s]
train epoch:16:   0%|                                                                                                                                                       | 1/20227 [00:00<2:47:43,  2.01it/s]
Average loss for epoch 15: val_total_loss_cond:0.016835786402225494; val_total_loss:0.016835786402225494; val_loss_map_hand:0.0; val_loss_map_om:0.016835786402225494; val_loss_feat:0.0;


train epoch:16:   0%|                                                                                                                                                      | 11/20227 [00:05<2:47:54,  2.01it/s]
Traceback (most recent call last):
  File "traineval.py", line 63, in <module>
    train_val(trainloader, valloader, testloader)
  File "traineval.py", line 24, in train_val
    checkpoints = trainer.epoch(epoch + 1)
  File "/home/datassd/yilin/Codes/Hand/ConditionHOI/epochbase.py", line 247, in epoch
    self.one_batch(sample)
  File "/home/datassd/yilin/Codes/Hand/ConditionHOI/epochbase.py", line 201, in one_batch
    self.model_update(dict_losses)
  File "/home/datassd/yilin/Codes/Hand/ConditionHOI/epochbase.py", line 175, in model_update
    self.optimizer_cond.step()
  File "/home/yilin/anaconda3/envs/pytorch3d/lib/python3.8/site-packages/torch/optim/optimizer.py", line 88, in wrapper
    return func(*args, **kwargs)
  File "/home/yilin/anaconda3/envs/pytorch3d/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/yilin/anaconda3/envs/pytorch3d/lib/python3.8/site-packages/torch/optim/adam.py", line 107, in step
    F.adam(params_with_grad,
  File "/home/yilin/anaconda3/envs/pytorch3d/lib/python3.8/site-packages/torch/optim/_functional.py", line 94, in adam
    denom = (exp_avg_sq.sqrt() / math.sqrt(bias_correction2)).add_(eps)
KeyboardInterrupt